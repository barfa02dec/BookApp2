package com.app.controller;

import java.io.IOException;
import java.util.List;

import javax.servlet.annotation.MultipartConfig;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.multipart.MultipartFile;

import com.app.exception.BookException;
import com.app.model.Book;
import com.app.service.BookServiceInf;

@CrossOrigin(origins = "http://localhost:4200",allowedHeaders = "*")
@RestController
public class BookController {

	@Autowired
	private BookServiceInf admin_sevice;

	/********* Insert Book 
	 * @throws IOException ************/

	@PostMapping("/add_book")
	public void registerUserProfile(@RequestParam(name = "imageFile") MultipartFile image) throws IOException {
		Book book = new Book();
		book.setImage(image.getBytes());
		admin_sevice.addBook(book);
	}

	/************** Select Books ******************/
	
	@GetMapping("/get_all_books")
	public @ResponseBody List<Book> getAllBooks(){
		return admin_sevice.getAllBook();
	}
	
	@GetMapping("/get_book_by_id")
	public @ResponseBody Book getBookById(@RequestParam(name = "id") int book_id) throws BookException {
		return admin_sevice.getBookById(book_id);
	}
	
	@GetMapping("/get_book_by_name")
	public @ResponseBody List<Book> getBookByName(@RequestParam(name = "name") String name) throws BookException {
		return admin_sevice.getBookByName(name);
	}

	/**************** Remove Book ************************/
	
	@DeleteMapping("/remove_book")
	public boolean removeBook(@RequestParam(name = "id") int id) throws BookException {
		return admin_sevice.removeBook(id);		
	}
	@DeleteMapping("/remove_book_by_name")
	public @ResponseBody int removeBookByName(@RequestParam(name = "name") String name) throws BookException {
		return admin_sevice.removeBookByName(name);		
	}

	/********************* Update Book *************************/
	
	@PostMapping("/update_book")
	public Book updateBook(@RequestBody Book book) throws BookException {
		return admin_sevice.updateBook(book);		
	}
}
